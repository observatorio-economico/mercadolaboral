hombres <- edad25a34 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(percent(sum(PONDERA)/sum(hombres$PONDERA)))
hombres
#Mujeres
mujeres <- edad25a34 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (percent(sum(PONDERA)/sum(mujeres$PONDERA)))
mujeres
#35-44
edad35a44 <- eph3t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=44 & CH06>=35 & !is.na(INFORMALES))
#Hombres
hombres <- edad35a44 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(percent(sum(PONDERA)/sum(hombres$PONDERA)))
hombres
#Mujeres
mujeres <- edad35a44 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (percent(sum(PONDERA)/sum(mujeres$PONDERA)))
mujeres
#45-59
edad45a59 <- eph3t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=59 & CH06>=45 & !is.na(INFORMALES))
#Hombres
hombres <- edad45a59 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(percent(sum(PONDERA)/sum(hombres$PONDERA)))
hombres
#Mujeres
mujeres <- edad45a59 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (percent(sum(PONDERA)/sum(mujeres$PONDERA)))
mujeres
#Mayores o iguales a 60 años
edad60 <- eph3t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06>=60 & !is.na(INFORMALES))
#Hombres
hombres <- edad60 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(percent(sum(PONDERA)/sum(hombres$PONDERA)))
hombres
#Mujeres
mujeres <- edad60 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (percent(sum(PONDERA)/sum(mujeres$PONDERA)))
mujeres
formales<- informalidad %>% filter(INFORMALES==0)
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(INFORMALES==1)
informales1<- informales %>% group_by(CH04) %>% summarise(sum(PONDERA)/sum(informales$PONDERA), sum(PONDERA))
informales1
formales<- informalidad %>% filter(INFORMALES==0)
formales<- formales %>% group_by(CH04) %>% summarise(sum(PONDERA)/(sum(formales$PONDERA)))
formales
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(INFORMALES==1)
informales1<- informales %>% group_by(CH04) %>% summarise(sum(PONDERA)/sum(informales$PONDERA), sum(PONDERA))
informales1
inforporsector<- function(i) {
infor <- sectores %>% filter(AGLOMERADO==12  & !is.na(INFORMALES) & SECTOR_ACT==i)
infor <- infor %>% group_by(INFORMALES) %>%  summarise(formattable::percent(sum(PONDERA)/sum(infor$PONDERA), digits=2))
return(infor)
}
nombres<-(unique(sectores$SECTOR_ACT))
nombres
sectores %>% filter(SECTOR_ACT=="EXPLOTACIÓN DE MINAS Y CANTERAS" & AGLOMERADO==12  & !is.na(INFORMALES)) %>% group_by(INFORMALES) %>% summarise(n())
inforporsector("INFORMACIÓN Y COMUNICACIÓN")
inforporsector("ENSEÑANZA")
inforporsector("CONSTRUCCIÓN")
inforporsector("ADMINISTRACIÓN PÚBLICA Y DEFENSA; PLANES DE SEGURO SOCIAL OBLIGATORIO" )
inforporsector("ACTIVIDADES PROFESIONALES, CIENTÍFICAS Y TÉCNICAS")
inforporsector("SALUD HUMANA Y SERVICIOS SOCIALES")
inforporsector("ACTIVIDADES FINANCIERAS Y DE SEGUROS" )
inforporsector("COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACIÓN DE VEHÍCULOS AUTOMOTORES Y MOTOCICLETAS")
inforporsector("INDUSTRIA MANUFACTURERA")
inforporsector("TRANSPORTE Y ALMACENAMIENTO" )
inforporsector("ARTES, ENTRETENIMIENTO Y RECREACIÓN")
inforporsector("AGRICULTURA, GANADERÍA, CAZA, SILVICULTURA Y PESCA")
inforporsector("ACTIVIDADES DE LOS HOGARES COMO EMPLEADORES DE\nPERSONAL DOMÉSTICO" )
inforporsector("OTRAS ACTIVIDADES DE SERVICIOS")
inforporsector("ACTIVIDADES DE ORGANIZACIONES Y ORGANISMOS\nEXTRATERRITORIALES")
inforporsector("ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO" )
inforporsector("ALOJAMIENTO Y SERVICIOS DE COMIDAS")
inforporsector("EXPLOTACIÓN DE MINAS Y CANTERAS")
inforporsector("SUMINISTRO DE ELECTRICIDAD, GAS, VAPOR Y AIRE\nACONDICIONADO")
inforporsector("SUMINISTRO DE AGUA; ALCANTARILLADO, GESTIÓN DE DESECHOS Y ACTIVIDADES DE SANEAMIENTO")
inforporsector("ACTIVIDADES INMOBILIARIAS" )
inforporsector("INFORMACIÓN Y COMUNICACIÓN")
inforporsector("ENSEÑANZA")
inforporsector("CONSTRUCCIÓN")
inforporsector("ADMINISTRACIÓN PÚBLICA Y DEFENSA; PLANES DE SEGURO SOCIAL OBLIGATORIO" )
inforporsector("ACTIVIDADES PROFESIONALES, CIENTÍFICAS Y TÉCNICAS")
inforporsector("SALUD HUMANA Y SERVICIOS SOCIALES")
inforporsector("ACTIVIDADES FINANCIERAS Y DE SEGUROS" )
inforporsector("COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACIÓN DE VEHÍCULOS AUTOMOTORES Y MOTOCICLETAS")
inforporsector("COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACIÓN DE VEHÍCULOS AUTOMOTORES Y MOTOCICLETAS")
inforporsector("INDUSTRIA MANUFACTURERA")
inforporsector("TRANSPORTE Y ALMACENAMIENTO" )
inforporsector("ARTES, ENTRETENIMIENTO Y RECREACIÓN")
table(sectores$SECTOR_ACT)
inforporsector("AGRICULTURA, GANADERÍA, CAZA, SILVICULTURA Y PESCA")
inforporsector("ACTIVIDADES DE LOS HOGARES COMO EMPLEADORES DE\nPERSONAL DOMÉSTICO" )
inforporsector("OTRAS ACTIVIDADES DE SERVICIOS")
inforporsector("OTRAS ACTIVIDADES DE SERVICIOS")
inforporsector("ACTIVIDADES DE ORGANIZACIONES Y ORGANISMOS\nEXTRATERRITORIALES")
inforporsector("ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO" )
inforporsector("ALOJAMIENTO Y SERVICIOS DE COMIDAS")
inforporsector("EXPLOTACIÓN DE MINAS Y CANTERAS")
inforporsector("SUMINISTRO DE ELECTRICIDAD, GAS, VAPOR Y AIRE\nACONDICIONADO")
inforporsector("SUMINISTRO DE AGUA; ALCANTARILLADO, GESTIÓN DE DESECHOS Y ACTIVIDADES DE SANEAMIENTO")
inforporsector("ACTIVIDADES INMOBILIARIAS" )
inforporsector("TRANSPORTE Y ALMACENAMIENTO" )
#Segundo trimestre 2020
ephi <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\2do trimestre\\usu_Individual_T220.txt", header=T, sep = ";", dec= ",")
ephh <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\2do trimestre\\usu_hogar_T220.txt", header=T, sep = ";", dec= ",")
eph2t<- left_join(ephi, ephh)
#Primer trimestre 2020
ephi <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\1er trimestre\\usu_individual_T120.txt", header=T, sep = ";", dec= ",")
ephh <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\1er trimestre\\usu_hogar_T120.txt", header=T, sep = ";", dec= ",")
eph1t<- left_join(ephi, ephh)
#Cuarto trimestre 2019
ephi <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2019\\4to trimestre\\usu_individual_T419.txt", header=T, sep = ";", dec= ",")
ephh <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2019\\4to trimestre\\usu_hogar_T419.txt", header=T, sep = ";", dec= ",")
eph4t2019<- left_join(ephi, ephh)
#Tercer trimestre 2019
ephi <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2019\\3er trimestre\\Usu_individual_T319.txt", header=T, sep = ";", dec= ",")
ephh <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2019\\3er trimestre\\Usu_hogar_T319.txt", header=T, sep = ";", dec= ",")
eph3t2019<- left_join(ephi, ephh)
ephtotal <- bind_rows(eph2t, eph1t, eph4t2019, eph3t2019)
ephtotalsd <- ephtotal %>% distinct(., CODUSU, NRO_HOGAR, COMPONENTE, .keep_all = T)
ephtotalsd <- ephtotalsd %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
calificacionhombres<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==1)
calificacionhombres<- calificacionhombres %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(calificacionhombres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionhombres
calificacionmujeres<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==2)
calificacionmujeres<- calificacionmujeres %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(calificacionmujeres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionmujeres
pobcalificada<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION))
pobcalificada<- pobcalificada %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(pobcalificada$PONDERA)),  sum(PONDERA), sum(pobcalificada$PONDERA))
pobcalificada
eph3t <- eph3t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
#Tercer trimestre 2020
ephi <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\3er trimestre\\usu_individual_T320.txt", header=T, sep = ";", dec= ",")
ephh <- read.table("C:\\Users\\Lenovo\\Desktop\\MUNI\\DATOS\\CARPETA MIA\\EPH\\2020\\3er trimestre\\usu_hogar_T320.txt", header=T, sep = ";", dec= ",")
eph3t<- left_join(ephi, ephh)
eph3t <- eph3t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
pobcalificada<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION))
pobcalificada<- pobcalificada %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(pobcalificada$PONDERA)),  sum(PONDERA), sum(pobcalificada$PONDERA))
pobcalificada
pobcalificada<- eph3t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION))
pobcalificada<- pobcalificada %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(pobcalificada$PONDERA)),  sum(PONDERA), sum(pobcalificada$PONDERA))
pobcalificada
calificacionhombres<- eph3t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==1)
calificacionhombres<- calificacionhombres %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(calificacionhombres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionhombres
calificacionmujeres<- eph3t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==2)
calificacionmujeres<- calificacionmujeres %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(calificacionmujeres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionmujeres
califporsector<- function(i) {
calif <- sectores %>% filter(AGLOMERADO==12  & !is.na(TIPOCALIFICACION) & SECTOR_ACT==i)
calif <- calif %>% group_by(TIPOCALIFICACION) %>%  summarise(formattable::percent(sum(PONDERA)/sum(calif$PONDERA), digits=2))
return(calif)
}
califporsector("INFORMACIÓN Y COMUNICACIÓN")
califporsector("ENSEÑANZA")
califporsector("INFORMACIÓN Y COMUNICACIÓN")
califporsector("CONSTRUCCIÓN")
knitr::opts_chunk$set(echo = TRUE)
library(eph)
library(tidyverse)
library(formattable)
#Tercer trimestre 2020
eph3ti<- get_microdata(year=2020, trimester=3, type="individual")
eph3tih <- get_microdata(year=2020, trimester=3, type="hogar")
eph3t <- left_join(eph3ti, eph3tih)
eph3t$PP04B_COD <- as.character(eph3t$PP04B_COD)
eph3t$PP11B_COD <- as.character(eph3t$PP11B_COD)
eph3t$PP11D_COD <- as.character(eph3t$PP11D_COD)
eph3ti<- get_microdata(year=2020, trimester=3, type="individual")
eph3tih <- get_microdata(year=2020, trimester=3, type="hogar")
eph3t <- left_join(eph3ti, eph3tih)
eph3t$PP04B_COD <- as.character(eph3t$PP04B_COD)
eph3t$PP11B_COD <- as.character(eph3t$PP11B_COD)
eph3t$PP11D_COD <- as.character(eph3t$PP11D_COD)
eph3t <- eph3t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
#Proporcion de mujeres que conforman la PEA sobre el total de mujeres:
tablapeamujeres <- eph3t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & CH04==2)
tablapeamujeres <- tablapeamujeres %>% group_by(PEA) %>%  summarise(sum(PONDERA)/sum(tablapeamujeres$PONDERA))
tablapeamujeres
#Proporcion de hombres que conforman la PEA sobre el total de hombres:
tablapeahombres <- eph3t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & CH04==1)
tablapeahombres <- tablapeahombres %>% group_by(PEA) %>% summarise(sum(PONDERA)/sum(tablapeahombres$PONDERA))
tablapeahombres
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(INFORMALES==1)
informales1<- informales %>% group_by(CH04) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
formales<- informalidad %>% filter(INFORMALES==0)
formales<- formales %>% group_by(CH04) %>% summarise(sum(PONDERA)/(sum(formales$PONDERA)))
formales
#Tercer trimestre 2020
eph3ti<- get_microdata(year=2020, trimester=3, type="individual")
eph3tih <- get_microdata(year=2020, trimester=3, type="hogar")
#Segundo trimestre 2020
eph2ti<- get_microdata(year=2020, trimester=2, type="individual")
eph2tih <- get_microdata(year=2020, trimester=2, type="hogar")
#Arreglos en la base del tercer trimestre 2020
eph3t <- left_join(eph3ti, eph3tih)
eph3t$PP04B_COD <- as.character(eph3t$PP04B_COD)
eph3t$PP11B_COD <- as.character(eph3t$PP11B_COD)
eph3t$PP11D_COD <- as.character(eph3t$PP11D_COD)
eph2t <- left_join(eph2ti, eph2tih)
#Y listo
#Primer trimestre 2020
ephi<- get_microdata(year=2020, trimester = 1, type = "individual")
ephh<- get_microdata(year=2020, trimester = 1, type = "hogar")
eph1t<- left_join(ephi, ephh)
#Cuarto 2019
ephi<- get_microdata(year=2019, trimester = 4, type = "individual")
ephh<- get_microdata(year=2019, trimester = 4, type = "hogar")
eph4t2019<- left_join(ephi, ephh)
ephtotal <- bind_rows(eph3t, eph2t, eph1t, eph4t2019)
#Quitar duplicados:
ephtotalsd <- ephtotal %>% distinct(., CODUSU, NRO_HOGAR, COMPONENTE, .keep_all = T)
#Tercero 2019
ephi<- get_microdata(year=2019, trimester = 3, type = "individual")
ephh<- get_microdata(year=2019, trimester = 3, type = "hogar")
eph3t2019<- left_join(ephi, ephh)
ephtotal <- bind_rows(eph2t, eph1t, eph4t2019, eph3t2019)
#Quitar duplicados:
ephtotalsd <- ephtotal %>% distinct(., CODUSU, NRO_HOGAR, COMPONENTE, .keep_all = T)
informalidad<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(INFORMALES==1)
informales1<- informales %>% group_by(CH04) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
ephtotalsd <- ephtotalsd %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados",
TRUE ~ "0"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
informalidad<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(INFORMALES==1)
informales1<- informales %>% group_by(CH04) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
informalidad<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==1)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
informalidad<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==2)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
#Mujeres
informalidad<- ephtotalsd %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==2)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
eph3t <- eph3t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
#Tercer trimestre 2020
eph3ti<- get_microdata(year=2020, trimester=3, type="individual")
eph3tih <- get_microdata(year=2020, trimester=3, type="hogar")
eph3t <- left_join(eph3ti, eph3tih)
eph3t$PP04B_COD <- as.character(eph3t$PP04B_COD)
eph3t$PP11B_COD <- as.character(eph3t$PP11B_COD)
eph3t$PP11D_COD <- as.character(eph3t$PP11D_COD)
eph3t <- eph3t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
ESTADO==4 ~ 0,
ESTADO==1 ~ 1,
ESTADO==2 ~ 1),
OCUPADOS= case_when(ESTADO==1 ~ 1,
ESTADO==2 ~ 0,
ESTADO==3 ~ 0,
ESTADO==4 ~ 0),
DESOCUPADOS= case_when(ESTADO==1 ~ 0,
ESTADO==2 ~ 1),
EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
PP04A==2 ~ "Empleados privados",
PP04A==3 ~ "Otros",
TRUE ~ NA_character_),
PP04B_COD=as.character(PP04B_COD),
PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
SECTOR= substr(PP04B_COD,1,2),
INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
CAT_OCUP==3 & PP07H==1 ~ 0),
PP04D_COD = as.character(PP04D_COD),
PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
CALIFICACION = substr(PP04D_COD, 5, 5),
CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
CALIFICACION=="2" ~ "Técnicos",
CALIFICACION=="3" ~ "Operativos",
CALIFICACION=="4" ~ "No Calificados"),
CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==2)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
#Hombres
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==1)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
informalidad<- eph3t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==2)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1
