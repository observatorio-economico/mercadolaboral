---
title: "Mercado laboral 4t 2020"
author: "Valeria Salas"
date: "18/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(ggtext)
library(eph)
library(tidyverse)
library(formattable)
library(Hmisc)
library(readxl)
library(foreign)
library(glue)
library(extrafont)
library(ggalt)
library(waffle)
library(ggimage)
library(spatstat)
library(splitstackshape)
library(purrr)
library(treemapify)
library(scales)
library(forcats)
library(svglite)
library(ggchicklet)
library(ggpubr)


#Fuente
font_import(paths = "~/GitHub/informegenero/Open_Sans")
loadfonts(device = "win", quiet=T)

#Colores
colores<- c("#29aee4","#0c8136","#e22172","#f4a018","#428cb4","#c85687","#dbac2f","#5da14a","#ff9a00")
gradiente<- c("#ed3068","#ef4275","#f3789d","#f69cb7","#fbd2de")

 
#Cuarto trimestre 2020
eph4ti<- get_microdata(year=2020, trimester=4, type="individual")
eph4tih <- get_microdata(year=2020, trimester=4, type="hogar")

eph4t <- left_join(eph4ti, eph4tih)


eph4t$PP04B_COD <- as.character(eph4t$PP04B_COD)
eph4t$PP11B_COD <- as.character(eph4t$PP11B_COD)
eph4t$PP11D_COD <- as.character(eph4t$PP11D_COD)

```

```{r}
eph4t <- eph4t %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
                                                      ESTADO==4 ~ 0,
                                                      ESTADO==1 ~ 1,
                                                      ESTADO==2 ~ 1),
                                       OCUPADOS= case_when(ESTADO==1 ~ 1,
                                                           ESTADO==2 ~ 0,
                                                           ESTADO==3 ~ 0,
                                                           ESTADO==4 ~ 0),
                                       DESOCUPADOS= case_when(ESTADO==1 ~ 0,
                                                              ESTADO==2 ~ 1),
                                       EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
                                                            PP04A==2 ~ "Empleados privados",
                                                            PP04A==3 ~ "Otros",
                                                            TRUE ~ NA_character_),
                                       PP04B_COD=as.character(PP04B_COD),
                                       PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
                                                       nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
                                                       nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
                                                       nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
                                       SECTOR= substr(PP04B_COD,1,2),
                                       INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
                                                             CAT_OCUP==3 & PP07H==1 ~ 0),
                                       PP04D_COD = as.character(PP04D_COD),
                                       PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
                                                             nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
                                                             nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
                                                             nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
                                                             nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
                                       CALIFICACION = substr(PP04D_COD, 5, 5),
                                       CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
                                                                CALIFICACION=="2" ~ "Técnicos",
                                                                CALIFICACION=="3" ~ "Operativos",
                                                                CALIFICACION=="4" ~ "No Calificados"),
                                       CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
                                       TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
                                                                          CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"),
                           SEXO= case_when(CH04==1 ~ "Hombres",
                                           CH04==2 ~ "Mujeres"))
                                

```

##Tasa de participación laboral
###Tasa de participación laboral total de la poblacion
```{r}
#Primero se filtra la base
tablapeapt <- eph4t %>% filter (AGLOMERADO==12 & ESTADO!=0)
#Ahora armamos la tabla (cantidad de 1 sobre cantidad de 0 y 1) y se agrupa entre 0 y 1 (PEA==1), ademas se agrega la cantidad de habitantes dentro de la PEA.
tablapeapt <- tablapeapt %>% group_by(PEA) %>%  summarise((formattable::percent(sum(PONDERA)/sum(tablapeapt$PONDERA))), sum(PONDERA), sum(tablapeapt$PONDERA))
tablapeapt

```
###Tasa de participación laboral por sexo
```{r }
tablapeasexo<- eph4t %>% filter (AGLOMERADO==12 & ESTADO!=0 & PEA==1)
tablapeasexo <- tablapeasexo %>% group_by(CH04) %>%  summarise(sum(PONDERA), formattable::percent(sum(PONDERA)/sum(tablapeasexo$PONDERA)))
tablapeasexo 

#Proporcion de mujeres que conforman la PEA sobre el total de mujeres:
tablapeamujeres <- eph4t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & CH04==2)
tablapeamujeres <- tablapeamujeres %>% group_by(PEA) %>%  summarise(sum(PONDERA)/sum(tablapeamujeres$PONDERA), sum(PONDERA))
tablapeamujeres

#Proporcion de hombres que conforman la PEA sobre el total de hombres:
tablapeahombres <- eph4t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & CH04==1)
tablapeahombres <- tablapeahombres %>% group_by(PEA) %>% summarise(sum(PONDERA)/sum(tablapeahombres$PONDERA), sum(PONDERA))
tablapeahombres
```
###Tasa de participación laboral por edad y sexo
```{r}
#15-24 años

edad15a24 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=24 & CH06>=15)

#Hombres
hombres15 <- edad15a24 %>%  filter(CH04==1)
hombres15 <- hombres15 %>%  group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombres15$PONDERA)),2), Sexo="Hombres", Edad="15-24 años")
hombres15
hombresact15 <- hombres15 %>% filter(PEA==1)  %>% select(-PEA)
hombresact15

#Mujeres
mujeres15 <- edad15a24 %>%  filter(CH04==2)
mujeres15 <- mujeres15 %>%  group_by(PEA) %>%  summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeres15$PONDERA)),2), Sexo="Mujeres", Edad="15-24 años")
mujeres15

mujeresact15 <- mujeres15 %>% filter(PEA==1)  %>% select(-PEA)
mujeresact15

act15a24 <- bind_rows(hombresact15, mujeresact15)
act15a24


#25-34 años

edad25a34 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=34 & CH06>=25)

#Hombres
hombres25 <- edad25a34 %>%  filter(CH04==1)
hombres25 <- hombres25 %>%  group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombres25$PONDERA)),2), Sexo="Hombres", Edad="25-34 años")
hombres25
hombresact25 <- hombres25 %>% filter(PEA==1) %>% select(-PEA)  
hombresact25

#Mujeres
mujeres25 <- edad25a34 %>%  filter(CH04==2)
mujeres25 <- mujeres25 %>%  group_by(PEA) %>%  summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeres25$PONDERA)),2), Sexo="Mujeres", Edad="25-34 años")
mujeres25

mujeresact25 <- mujeres25 %>% filter(PEA==1) %>% select(-PEA)  
mujeresact25

act25a34 <- bind_rows(hombresact25, mujeresact25)
act25a34


#35-44
edad35a44 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=44 & CH06>=35)

#Hombres
hombres35 <- edad35a44 %>%  filter(CH04==1)
hombres35 <- hombres35 %>%  group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombres35$PONDERA)),2), Sexo="Hombres", Edad="35-44 años")
hombres35
hombresact35 <- hombres35 %>% filter(PEA==1) %>% select(-PEA)  
hombresact35

#Mujeres
mujeres35 <- edad35a44 %>%  filter(CH04==2)
mujeres35 <- mujeres35 %>%  group_by(PEA) %>%  summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeres35$PONDERA)),2), Sexo="Mujeres", Edad="35-44 años")
mujeres35

mujeresact35 <- mujeres35 %>% filter(PEA==1) %>% select(-PEA)  
mujeresact35

act35a44 <- bind_rows(hombresact35, mujeresact35)
act35a44

#45-59
edad45a59 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=59 & CH06>=45)

#Hombres
hombres45 <- edad45a59 %>%  filter(CH04==1)
hombres45 <- hombres45 %>%  group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombres45$PONDERA)),2), Sexo="Hombres", Edad="45-59 años")
hombres45
hombresact45 <- hombres45 %>% filter(PEA==1) %>% select(-PEA)  
hombresact45

#Mujeres
mujeres45 <- edad45a59 %>%  filter(CH04==2)
mujeres45 <- mujeres45 %>%  group_by(PEA) %>%  summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeres45$PONDERA)),2), Sexo="Mujeres", Edad="45-59 años")
mujeres45

mujeresact45 <- mujeres45 %>% filter(PEA==1) %>% select(-PEA)  
mujeresact45

act45a59 <- bind_rows(hombresact45, mujeresact45)
act45a59

#Mayores o iguales a 60 años
edad60 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06>=60)

#Hombres
hombres60 <- edad60 %>%  filter(CH04==1)
hombres60 <- hombres60 %>%  group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombres60$PONDERA)),2), Sexo="Hombres", Edad="Mayores o iguales a 60 años")
hombres60
hombresact60 <- hombres60 %>% filter(PEA==1) %>% select(-PEA)  
hombresact60

#Mujeres
mujeres60 <- edad60 %>%  filter(CH04==2)
mujeres60 <- mujeres60 %>%  group_by(PEA) %>%  summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeres60$PONDERA)),2), Sexo="Mujeres", Edad="Mayores o iguales a 60 años")
mujeres60

mujeresact60 <- mujeres60 %>% filter(PEA==1) %>% select(-PEA)  
mujeresact60

act60 <- bind_rows(hombresact60, mujeresact60)
act60


#TABLA 
activsgraf <- bind_rows(act15a24, act25a34, act35a44, act45a59, act60)
activsgraf

activsgraf %>% pivot_wider(names_from = "Sexo", values_from= "porcentaje")


```

```{r}
grafico1 <- activsgraf %>% ggplot(mapping = aes(x=Edad, y=porcentaje, fill=Sexo)) + 
  geom_chicklet(position = position_dodge(width = 0.75), width=0.7, show.legend = F) + scale_fill_manual(values=colores) + scale_y_continuous(labels = percent, limits = c(0,1)) + labs(y = "Tasa de participación laboral", title ="Participación laboral por edad para <span style = 'color: #29aee4;'>**hombres**</span> y <span style='color: #0c8136;'>**mujeres**</span> ", subtitle ="Cuarto trimestre 2020", x = "") + theme(text = element_text(family = "Open Sans"), plot.title = element_markdown(size = 14), plot.title.position = "plot", plot.subtitle = element_text(size = 8), axis.title = element_text(size=8), legend.position = "bottom", legend.text = element_text(size = 8), legend.title = element_blank(), axis.text = element_text(colour = "BLACK", family="Open Sans", size = 7), panel.background = element_blank(), panel.grid.major = element_blank()) 
grafico1
ggsave("grafico1.svg")

```

###Tasa de participación laboral por sexo y nivel educativo
```{r}
#Primaria completa
primariacompleta <- eph4t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & NIVEL_ED %in% c(2,3))
#Hombres:
hombresprim <- primariacompleta %>%  filter(CH04==1)
hombresprim <- hombresprim %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombresprim$PONDERA)),2), Sexo="Hombres", Nivel="Primaria Completa") %>% filter(PEA==1) %>% select(-PEA)
hombresprim 


#Mujeres:
mujeresprim <- primariacompleta %>%  filter(CH04==2)
mujeresprim <- mujeresprim %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeresprim$PONDERA)),2), Sexo="Mujeres", Nivel="Primaria Completa") %>% filter(PEA==1) %>% select(-PEA)
mujeresprim

primariacomp <- bind_rows(hombresprim, mujeresprim)
primariacomp

primariacomp<- primariacomp %>% mutate("Brecha"=formattable::percent((0.5161-0.2135)))
primariacomp

```


```{r}
#Secundaria completa
secundariacompleta <- eph4t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & NIVEL_ED %in% c(4,5))
#Hombres:
hombressec <- secundariacompleta %>%  filter(CH04==1)
hombressec <- hombressec %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombressec$PONDERA)),2), Sexo="Hombres", Nivel="Secundaria Completa") %>% filter(PEA==1) %>% select(-PEA)
hombressec 

#Mujeres:
mujeressec <- secundariacompleta %>%  filter(CH04==2)
mujeressec <- mujeressec %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeressec$PONDERA)),2), Sexo="Mujeres", Nivel="Secundaria Completa") %>% filter(PEA==1) %>% select(-PEA)
mujeressec

secundariacomp <- bind_rows(hombressec, mujeressec)
secundariacomp
secundariacomp <- secundariacomp%>% mutate("Brecha"=formattable::percent((0.6992-0.3997))) 
secundariacomp
```


```{r}
#Superior completo
superiorcompleto <- eph4t %>%  filter(AGLOMERADO==12 & ESTADO!=0 & NIVEL_ED==6)
#Hombres:
hombressup <- superiorcompleto %>%  filter(CH04==1)
hombressup <- hombressup %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(hombressup$PONDERA)),2), Sexo="Hombres", Nivel="Superior Completo") %>% filter(PEA==1) %>% select(-PEA)
hombressup 

#Mujeres:
mujeressup <- superiorcompleto %>%  filter(CH04==2)
mujeressup <- mujeressup %>% group_by(PEA) %>% summarise(porcentaje=formattable::percent((sum(PONDERA)/sum(mujeressup$PONDERA)),2), Sexo="Mujeres", Nivel="Superior Completo") %>% filter(PEA==1) %>% select(-PEA)
mujeressup

superiorcomp <- bind_rows(hombressup, mujeressup)
superiorcomp
superiorcomp <- superiorcomp %>% mutate("Brecha"=formattable::percent((0.8833-0.7376)))
superiorcomp
```


```{r}
nivelalcanzado <- bind_rows(primariacomp, secundariacomp, superiorcomp)
nivelalcanzado

nivelgraf <- pivot_wider(nivelalcanzado, names_from = "Sexo", values_from = "porcentaje")
nivelgraf

```

```{r}
grafico2 <- nivelalcanzado %>% ggplot() + geom_chicklet(aes(x=Nivel, y=porcentaje, fill=Sexo), position = position_dodge(), width = 0.5, show.legend = F) + geom_point(aes(x=Nivel, y=Brecha), shape=15) +  geom_line(aes(x=Nivel, y=Brecha, group = 1)) + scale_y_continuous(labels = percent, limits = c(0,1)) + scale_fill_manual(values=colores) + labs(title ="Participación laboral según nivel educativo para <span style = 'color: #29aee4;'>**hombres**</span> y <span style='color: #0c8136;'>**mujeres**</span> ", subtitle = "Cuarto trimestre 2020", x = "Nivel alcanzado", y="Tasa de participación laboral") + theme(text = element_text(family = "Open Sans"), plot.title = element_markdown(size = 14), plot.title.position = "plot", plot.subtitle = element_text(size = 8), axis.title = element_text(size=8), legend.position = "bottom", legend.text = element_text(size = 8), legend.title = element_text(), axis.text = element_text(colour = "BLACK", family="Open Sans", size = 7), panel.background = element_blank(), panel.grid.major = element_blank())  
grafico2


ggsave("grafico2.svg")
```


###Cantidad de horas trabajadas
```{r}
horastrabtotales <- eph4t %>% mutate(horastrabtotales= PP3E_TOT + PP3F_TOT)
#15-24 años
horastrab15 <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & CH06<=24 & CH06>=15 & !is.na(horastrabtotales))
horastrab15 <- horastrab15 %>%  group_by(CH04) %>% summarise(horas=horastrabtotales%*%PONDERA/sum(PONDERA), Edad= "15-24 años")
horastrab15 <- horastrab15 %>% arrange(horas) %>% mutate(Brecha=horas- lag(horas, default = first(horas)))
brecha15= round(as.numeric(horastrab15[2, "Brecha"]),2)
horastrab15 <- horastrab15 %>% mutate(Brecha= brecha15)
horastrab15
```


```{r}
#25-34
horastrab25 <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & CH06<=34 & CH06>=25 & !is.na(horastrabtotales))
horastrab25 <- horastrab25 %>%  group_by(CH04) %>% summarise(horas=horastrabtotales%*%PONDERA/sum(PONDERA), Edad="25-34 años")
horastrab25 <- horastrab25 %>% arrange(horas) %>% mutate(Brecha=horas- lag(horas, default = first(horas))) 
brecha25= round(as.numeric(horastrab25[2, "Brecha"]),2)
horastrab25 <- horastrab25 %>% mutate(Brecha= brecha25)
horastrab25

```


```{r}
#35 a 44
horastrab35 <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & CH06<=44 & CH06>=35 & !is.na(horastrabtotales))
horastrab35 <- horastrab35 %>%  group_by(CH04) %>% summarise(horas=horastrabtotales%*%PONDERA/sum(PONDERA), Edad="35-44 años")
horastrab35 <- horastrab35 %>% arrange(horas) %>% mutate(Brecha=horas- lag(horas, default = first(horas))) 
brecha35= round(as.numeric(horastrab35[2, "Brecha"]),2)
horastrab35 <- horastrab35 %>% mutate(Brecha= brecha35)
horastrab35
```


```{r}
#45 a 59
horastrab45 <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & CH06<=59 & CH06>=45 & !is.na(horastrabtotales))
horastrab45 <- horastrab45 %>%  group_by(CH04) %>% summarise(horas=horastrabtotales%*%PONDERA/sum(PONDERA), Edad="45-59 años")
horastrab45 <- horastrab45 %>% arrange(horas) %>% mutate(Brecha=horas- lag(horas, default = first(horas))) 
brecha45= round(as.numeric(horastrab45[2, "Brecha"]),2)
horastrab45 <- horastrab45 %>% mutate(Brecha= brecha45)
horastrab45
```


```{r}
#mayores de 60
horastrab60 <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & CH06>=60 & !is.na(horastrabtotales))
horastrab60 <- horastrab60 %>%  group_by(CH04) %>% summarise(horas=horastrabtotales%*%PONDERA/sum(PONDERA), Edad="Igual o mayor a 60 años")
horastrab60 <- horastrab60 %>% arrange(horas) %>% mutate(Brecha=horas- lag(horas, default = first(horas))) 
brecha60= round(as.numeric(horastrab60[2, "Brecha"]),2)
horastrab60 <- horastrab60 %>% mutate(Brecha= brecha60)
horastrab60
```


```{r}
#Total mujeres y hombres
horastrab <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & !is.na(horastrabtotales))
horastrab <- horastrab %>%  group_by(CH04) %>% summarise(horastrabtotales%*%PONDERA/sum(PONDERA))
horastrab

#Total de la poblacion
horastrab <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & !is.na(horastrabtotales))
horastrab <- horastrab %>% summarise(horastrabtotales%*%PONDERA/sum(PONDERA))
horastrab

horastrabajadas <- bind_rows(horastrab15, horastrab25, horastrab35, horastrab45, horastrab60)

horastrabajadasgr <- horastrabajadas %>% mutate(brecha= paste0(Brecha, " horas"))
#horastrabajadas %>% pivot_wider(names_from = as.character("CH04"), values_from = horas)


horastrabajadas_hombres <- horastrabajadas %>% filter(CH04==1) %>% mutate(horas=round(horas))
horastrabajadas_mujeres <- horastrabajadas %>% filter(CH04==2)  %>% mutate(horas=round(horas))


```
##Graficos
```{r}
#Opción treemaps
horastrabajadas_hombres %>% ggplot(aes(area = horas , label =paste(Edad,": " ,horas," horas", sep = ""), fill=Edad)) +
  geom_treemap(show.legend = F) + geom_treemap_text(show.legend = F,min.size = 2, family="Open Sans", grow = TRUE, colour = "white", place = "center") + scale_fill_manual(values=colores)+ labs(title = "Carga laboral semanal para hombres", subtitle = "Cuarto trimestre 2020", caption = "", fill="") +  theme(text = element_text(family = "Open Sans"),plot.title = element_text(size = 14), plot.subtitle = element_text(size = 8), aspect.ratio = 0.7, plot.background = element_blank(),panel.grid.major = element_blank() ,panel.grid.minor = element_blank(), panel.border = element_blank()) 
ggsave("grafico3.1.svg")

horastrabajadas_mujeres %>% ggplot(aes(area = horas , label =paste(Edad,": " ,horas," horas", sep = ""), fill=Edad)) +
  geom_treemap(show.legend = F) + geom_treemap_text(show.legend = F,min.size = 2, family="Open Sans", grow = TRUE, colour = "white", place = "center") + scale_fill_manual(values=colores)+ labs(title = "Carga laboral semanal para mujeres", subtitle = "Cuarto trimestre 2020", caption = "", fill="") +  theme(text = element_text(family = "Open Sans"),plot.title = element_text(size = 14), plot.subtitle = element_text(size = 8), aspect.ratio = 0.7, plot.background = element_blank(),panel.grid.major = element_blank() ,panel.grid.minor = element_blank(), panel.border = element_blank()) 
ggsave("grafico3.2.svg")

#Barras comparativo
grafico3 <- horastrabajadasgr %>%  ggplot(mapping = aes(x=Edad, y=horas, fill=as.character(CH04))) + geom_chicklet(position = position_dodge(), show.legend = F) + scale_fill_manual(values = colores, labels=c("Hombre", "Mujer") )  + labs(y="Horas trabajadas semanales", title = "Carga laboral semanal por edad para <span style = 'color: #29aee4;'>**hombres**</span> y <span style='color: #0c8136;'>**mujeres**</span>", subtitle = "Cuarto trimestre 2020", fill="", x="")  +  theme(text = element_text(family = "Open Sans"), plot.title = element_markdown(size = 14), plot.title.position = "plot", plot.subtitle = element_text(size = 8), axis.title = element_text(size=8), legend.position = "bottom", legend.text = element_text(size = 8), axis.text = element_text(colour = "BLACK", family="Open Sans", size = 7), panel.background = element_blank()) 
grafico3
ggsave("grafico3.svg")


##same pero mostrando brecha
#grafico3 <- horastrabajadasgr %>%  ggplot(mapping = aes(x=Edad, y=horas, fill=as.character(CH04))) + geom_chicklet(position = position_dodge(), show.legend = F) + geom_text(aes(x=Edad, y=42, label=brecha), position = position_dodge(preserve = "single", width = 0.1), family="Open Sans", color="grey12", size=3) + scale_fill_manual(values = colores, labels=c("Hombre", "Mujer") )  + labs(y="Horas trabajadas semanales", title = "Carga laboral semanal por edad y sexo", subtitle = "Tercer trimestre 2020", fill="", x="")  +  theme(text = element_text(family = "Open Sans"), plot.title = element_text(size = 14), plot.title.position = "plot", plot.subtitle = element_text(size = 8), axis.title = element_text(size=8), legend.position = "bottom", legend.text = element_text(size = 8), axis.text = element_text(colour = "BLACK", family="Open Sans", size = 7), panel.background = element_blank()) 
#grafico3

```

##Tasa de empleo
```{r}
empleo <- eph4t %>% filter(AGLOMERADO==12 & !is.na(OCUPADOS))
empleo <- empleo %>%  group_by(OCUPADOS) %>%  summarise(formattable::percent(sum(PONDERA)/sum(empleo$PONDERA)))
empleo


```

##Tasa de desocupación
```{r}
desocupacion <- eph4t %>% filter(AGLOMERADO==12 & !is.na(DESOCUPADOS))
desocupacion <- desocupacion %>%  group_by(DESOCUPADOS) %>%  summarise(formattable::percent(sum(PONDERA)/sum(desocupacion$PONDERA)))
desocupacion

```

#Graficos evolución desocupación y empleo
```{r}
Tasas<-read.csv("tasas_empleo_desocupacion.csv", sep = ";", colClasses = "character")
Tasas$empleo <- as.numeric(Tasas$empleo)
Tasas$desocupacion <- as.numeric(Tasas$desocupacion)
#geom_point(color="#e22172", size=1.7)

grafico4 <- Tasas %>%  ggplot() +  geom_col(aes(x=periodo, y=empleo, fill=empleo), size=1, show.legend = F) + geom_line(aes(x=periodo, y=desocupacion, group = 1), color="#0c8136", size=1.2)   + scale_y_continuous(limits = c(0,0.45)) +  labs(y = "", title ="Evolución de Tasas 2016-2020", subtitle ="<span style = 'color:  #1ba2d8 ;'>**Empleo**</span> y <span style='color: #0c8136;'>**Desocupación**</span>", x="") + theme(text = element_text(family = "Open Sans"), plot.title = element_markdown(size=14), plot.title.position = "plot", plot.subtitle = element_markdown(size = 8), axis.title = element_text(size=8), axis.text = element_text(colour = "BLACK", family="Open Sans", size = 7), panel.background = element_blank(), panel.grid.major = element_blank(), legend.title = element_blank(), legend.position = "bottom", aspect.ratio = (0.5), axis.text.x=element_text(angle=60, hjust=1)) + scale_color_manual(values = colores) 
grafico4 

ggsave("grafico4.svg")

```


##Composición del empleo 
###Empleados por sector público y privado 
```{r}
empleados <- eph4t %>% filter(AGLOMERADO==12 & !is.na(EMPLEADOS) & OCUPADOS==1)
table(empleados$EMPLEADOS)
empleados <- empleados %>%  group_by(EMPLEADOS) %>%  summarise(sum(PONDERA))
empleados
empleados <- empleados %>% filter(EMPLEADOS!="Otros") %>% mutate(porcentaje=(`sum(PONDERA)`/sum(empleados$`sum(PONDERA)`))) %>% select(EMPLEADOS, porcentaje) %>% mutate(numeros=round(porcentaje*100,0))
empleados

empleadosacum <- cumsum(empleados$porcentaje)
empleadosacum
empleadosacummin <- formattable::percent(c(0, head(empleadosacum, n=-1))) 
empleadosacummin
```

##Grafico 5

```{r}
#Waffle
#remotes::install_github("hrbrmstr/waffle")


grafico5 <- empleados %>% ggplot(mapping = aes(fill=EMPLEADOS, values=numeros)) +  geom_waffle(n_rows=9, size=1.1, show.legend = F, colour = "white") + theme_void() +scale_fill_manual(values = colores) +  labs(title="Composición del empleo por sectores <span style = 'color: #29aee4;'>**privado**</span> y <span style='color: #0c8136;'>**público**</span> ", subtitle = "Cuarto trimestre 2020") + theme(plot.title = element_markdown(size=14), text = element_text(family = "Open Sans"), plot.title.position = "plot" )
grafico5
ggsave("grafico5.svg")
```

####Composición del empleo público por sexo
```{r}
composicionempleadospu <- eph4t %>% filter(AGLOMERADO==12 & !is.na(EMPLEADOS) & PP04A==1)
composicionempleadospu <- composicionempleadospu %>%  group_by(SEXO) %>%  summarise(sum(PONDERA))
composicionempleadospu <- composicionempleadospu %>% mutate(porcentaje=formattable::percent(`sum(PONDERA)`/sum(composicionempleadospu$`sum(PONDERA)`)),  Empleo= "Publico")
composicionempleadospu
```

####Composición del empleo privado por sexo
```{r}
composicionempleadospr <- eph4t %>% filter(AGLOMERADO==12 & !is.na(EMPLEADOS) & PP04A==2)
composicionempleadospr <- composicionempleadospr %>%  group_by(SEXO) %>%  summarise(sum(PONDERA))
composicionempleadospr <- composicionempleadospr %>% mutate(porcentaje=formattable::percent(`sum(PONDERA)`/sum(composicionempleadospr$`sum(PONDERA)`)), Empleo= "Privado")
composicionempleadospr

```


```{r}
composicionempleados <- bind_rows(composicionempleadospr, composicionempleadospu)

#EMPLEO PRIVADO
composicionempleadospr$ymax <- cumsum(composicionempleadospr$porcentaje)

#Bottom of each rectangle
composicionempleadospr$ymin <- formattable::percent(c(0, head(composicionempleadospr$ymax, n=-1)))

#Label position
composicionempleadospr$labelPosition <- (composicionempleadospr$ymax + composicionempleadospr$ymin) / 2

#Label
composicionempleadospr$label <- paste0(composicionempleadospr$SEXO, "\n ", composicionempleadospr$porcentaje)



#torta
torta1 <- ggplot(composicionempleadospr, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=SEXO)) +
  geom_rect() +
  geom_text( x=1.75, aes(y=labelPosition, label=label, color=SEXO), size=4.7) +
  scale_fill_manual(values = c("#f4a018", "#e22172")) +
  scale_colour_manual(values=c("#f4a018", "#e22172")) +
  coord_polar(theta="y") +
  xlim(c(-1, 4)) +
  labs(title = "Composición del empleo privado", subtitle = "Cuarto Trimestre 2020") +
  theme_void() +
  theme(legend.position = "none", text = element_text(family = "Open Sans"), plot.title =element_text(size = 14), plot.subtitle = element_text(size = 8), legend.text = element_text(size = 8)) 
torta1 

ggsave("grafico6.1.svg")

#EMPLEO PUBLICO
composicionempleadospu$ymax <- cumsum(composicionempleadospu$porcentaje)

# Compute the bottom of each rectangle
composicionempleadospu$ymin <- formattable::percent(c(0, head(composicionempleadospu$ymax, n=-1)))

# Compute label position
composicionempleadospu$labelPosition <- (composicionempleadospu$ymax + composicionempleadospu$ymin) / 2

# Compute a good label
composicionempleadospu$label <- paste0(composicionempleadospu$SEXO, "\n ", composicionempleadospu$porcentaje)

#torta
torta2 <- ggplot(composicionempleadospu, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=SEXO)) +
  geom_rect() +
  geom_text( x=1.75, aes(y=labelPosition, label=label, color=SEXO), size=4.7) +
  scale_fill_manual(values = c("#29aee4","#0c8136")) +
  scale_colour_manual(values=c("#29aee4","#0c8136")) +
  coord_polar(theta="y") +
  xlim(c(-1, 4)) +
  labs(title = "Composición del empleo publico", subtitle = "Cuarto Trimestre 2020") +
  theme_void() +
  theme(legend.position = "none", text = element_text(family = "Open Sans"), plot.title =element_text(size = 14), plot.subtitle = element_text(size = 8), legend.text = element_text(size = 8)) 
torta2 

ggsave("grafico6.2.svg")

figure <- ggarrange(torta1, torta2,
                    ncol = 2, nrow = 1)
figure

ggsave("tortascombinadas.svg")
```


##Calificacion 
###Calificación total población
```{r}
pobcalificada<- eph4t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION))
pobcalificada<- pobcalificada %>% group_by(TIPOCALIFICACION) %>% summarise(porcentaje=formattable::percent(sum(PONDERA)/sum(pobcalificada$PONDERA)),  sum(PONDERA), sum(pobcalificada$PONDERA))
pobcalificada

```
###Sector privado
```{r}
clasificacionepr<- eph4t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & PP04A==2)
clasificacionepr<- clasificacionepr %>% group_by(TIPOCALIFICACION) %>% summarise(porcentaje=formattable::percent(sum(PONDERA)/sum(clasificacionepr$PONDERA)),  sum(PONDERA), sum(clasificacionepr$PONDERA))
clasificacionepr

```
###Sector público 
```{r}
clasificacionepub<- eph4t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & PP04A==1) 
clasificacionepub<- clasificacionepub %>% group_by(TIPOCALIFICACION) %>% summarise(porcentaje=formattable::percent(sum(PONDERA)/sum(clasificacionepub$PONDERA)), sum(PONDERA), sum(clasificacionepub$PONDERA))
clasificacionepub 
```

###Calificación Hombres
```{r}
calificacionhombres<- eph4t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==1) 
calificacionhombres<- calificacionhombres %>% group_by(TIPOCALIFICACION) %>% summarise(formattable::percent(sum(PONDERA)/sum(calificacionhombres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionhombres 

```


###Calificación Mujeres
```{r}
calificacionmujeres<- eph4t %>% filter(AGLOMERADO==12 & !is.na(CALIFICACION) & CH04==2) 
calificacionmujeres<- calificacionmujeres %>% group_by(TIPOCALIFICACION) %>% summarise(percent(sum(PONDERA)/sum(calificacionmujeres$PONDERA)), sum(PONDERA), sum(calificacionhombres$PONDERA))
calificacionmujeres 

```



##Carga laboral
###Sector público
```{r}
cargalaboralpub <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & !is.na(horastrabtotales) & PP04A==1)
cargalaboralpub <- cargalaboralpub %>% summarise(horastrabtotales%*%PONDERA/sum(PONDERA))
cargalaboralpub

```

###Sector privado
```{r}
cargalaboralpriv <- horastrabtotales %>% filter (AGLOMERADO==12 & ESTADO!=0 & !is.na(horastrabtotales) & PP04A==2)
cargalaboralpriv <- cargalaboralpriv %>% summarise(horastrabtotales%*%PONDERA/sum(PONDERA))
cargalaboralpriv

```

##Promedio de edad por sector
```{r}
promedioedad<- eph4t %>% filter(AGLOMERADO==12 &  OCUPADOS==1)
promedioedad<- promedioedad %>% group_by(EMPLEADOS) %>% summarise((CH06%*%PONDERA)/sum(PONDERA))
promedioedad
```

##Composición por sectores del sector público
```{r}
caract<- eph4t %>% group_by(SECTOR) %>% filter(OCUPADOS==1) %>% count()
caes<- read.csv("SECTORESCAES.csv", sep = ";", colClasses = "character")
sectores<- left_join(eph4t,caes)
table(sectores$SECTOR_ACT)

corro<- sectores %>% select(SECTOR_ACT,SECTOR, PP04B_COD, CH11, ESTADO, OCUPADOS, PONDERA)
corro

spublico<- sectores %>% filter(AGLOMERADO==12 & PP04A==1)
spublico <- spublico %>% group_by(SECTOR_ACT) %>% summarise(porcentaje=formattable::percent(sum(PONDERA)/sum(spublico$PONDERA)), sum(PONDERA))
spublico

```

##Informalidad
###Total
```{r}
informalidadtot<- eph4t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informalidadtot<- informalidadtot %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informalidadtot$PONDERA), sum(PONDERA))
informalidadtot
```

###Por sexo
```{r}
#Mujeres
informalidad<- eph4t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==2)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA), sum(PONDERA))
informales1 #tremenda la diferencia con el tercer trim

#Hombres
informalidad<- eph4t %>% filter(AGLOMERADO==12 & !is.na(INFORMALES))
informales<- informalidad %>% filter(CH04==1)
informales1<- informales %>% group_by(INFORMALES) %>% summarise(sum(PONDERA)/sum(informales$PONDERA))
informales1


```

```{r}
#15-24 años

edad15a24 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=24 & CH06>=15 & !is.na(INFORMALES))

#Hombres
hombres <- edad15a24 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(formattable::percent(sum(PONDERA)/sum(hombres$PONDERA)), Sexo="Hombres", Edad="15-24 años")
hombres 


#Mujeres
mujeres <- edad15a24 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (formattable::percent(sum(PONDERA)/sum(mujeres$PONDERA)), Sexo="Mujeres", Edad="15-24 años")
mujeres

#25-34 años
edad25a34 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=34 & CH06>=25 & !is.na(INFORMALES))

#Hombres
hombres <- edad25a34 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(formattable::percent(sum(PONDERA)/sum(hombres$PONDERA)), Sexo="Hombres", Edad="25-34 años") 
hombres

#Mujeres
mujeres <- edad25a34 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (formattable::percent(sum(PONDERA)/sum(mujeres$PONDERA)), Sexo="Mujeres", Edad="25-34 años")
mujeres

#35-44
edad35a44 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=44 & CH06>=35 & !is.na(INFORMALES))

#Hombres
hombres <- edad35a44 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(formattable::percent(sum(PONDERA)/sum(hombres$PONDERA)), Sexo="Hombres", Edad="35-44 años")
hombres

#Mujeres
mujeres <- edad35a44 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (formattable::percent(sum(PONDERA)/sum(mujeres$PONDERA)), Sexo="Mujeres", Edad="35-44 años")
mujeres

#45-59
edad45a59 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06<=59 & CH06>=45 & !is.na(INFORMALES))

#Hombres
hombres <- edad45a59 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(formattable::percent(sum(PONDERA)/sum(hombres$PONDERA)), Sexo="Hombres", Edad="45-59 años")
hombres

#Mujeres
mujeres <- edad45a59 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (formattable::percent(sum(PONDERA)/sum(mujeres$PONDERA)), Sexo="Mujeres", Edad="45-59 años")
mujeres

#Mayores o iguales a 60 años
edad60 <- eph4t %>% filter(AGLOMERADO==12 & ESTADO!=0 & CH06>=60 & !is.na(INFORMALES))

#Hombres
hombres <- edad60 %>%  filter(CH04==1)
hombres <- hombres %>%  group_by(INFORMALES) %>% summarise(formattable::percent(sum(PONDERA)/sum(hombres$PONDERA)), Sexo="Hombres", Edad="+60 años")
hombres

#Mujeres
mujeres <- edad60 %>%  filter(CH04==2)
mujeres <- mujeres %>%  group_by(INFORMALES) %>%  summarise (formattable::percent(sum(PONDERA)/sum(mujeres$PONDERA)), Sexo="Mujeres", Edad="+60 años") 
mujeres 
```


##SECTORES
```{r}
#Tercer trimestre 2020
ephi<- get_microdata(year=2020, trimester=3, type="individual")
ephh <- get_microdata(year=2020, trimester=3, type="hogar")
eph3t <- left_join(ephi, ephh)
ephtotal <- bind_rows(eph4t, eph3t)
ephtotalsd <- ephtotal %>% distinct(., CODUSU, NRO_HOGAR, COMPONENTE, .keep_all = T) 

ephtotalsd <- ephtotalsd %>%  mutate(PEA= case_when(ESTADO==3 ~ 0,
                                                      ESTADO==4 ~ 0,
                                                      ESTADO==1 ~ 1,
                                                      ESTADO==2 ~ 1),
                                       OCUPADOS= case_when(ESTADO==1 ~ 1,
                                                           ESTADO==2 ~ 0,
                                                           ESTADO==3 ~ 0,
                                                           ESTADO==4 ~ 0),
                                       DESOCUPADOS= case_when(ESTADO==1 ~ 0,
                                                              ESTADO==2 ~ 1),
                                       EMPLEADOS= case_when(PP04A==1 ~ "Empleados Publicos",
                                                            PP04A==2 ~ "Empleados privados",
                                                            PP04A==3 ~ "Otros",
                                                            TRUE ~ NA_character_),
                                       PP04B_COD=as.character(PP04B_COD),
                                       PP04B_COD=case_when(nchar(PP04B_COD)==4~PP04B_COD,
                                                       nchar(PP04B_COD)==1~ paste0("0",PP04B_COD,"00"),
                                                       nchar(PP04B_COD)==2~ paste0(PP04B_COD,"00"),
                                                       nchar(PP04B_COD)==3~ paste0("0",PP04B_COD)),
                                       SECTOR= substr(PP04B_COD,1,2),
                                       INFORMALES=case_when( CAT_OCUP==3 & PP07H==2 ~ 1,
                                                             CAT_OCUP==3 & PP07H==1 ~ 0),
                                       PP04D_COD = as.character(PP04D_COD),
                                       PP04D_COD = case_when(nchar(PP04D_COD) == 5 ~ PP04D_COD,
                                                             nchar(PP04D_COD) == 4 ~ paste0("0", PP04D_COD),
                                                             nchar(PP04D_COD) == 3 ~ paste0("00", PP04D_COD),
                                                             nchar(PP04D_COD) == 2 ~ paste0("000", PP04D_COD),
                                                             nchar(PP04D_COD) == 1 ~ paste0("0000", PP04D_COD)),
                                       CALIFICACION = substr(PP04D_COD, 5, 5),
                                       CALIFICACION = case_when(CALIFICACION=="1" ~ "Profesionales",
                                                                CALIFICACION=="2" ~ "Técnicos",
                                                                CALIFICACION=="3" ~ "Operativos",
                                                                CALIFICACION=="4" ~ "No Calificados"),
                                       CALIFICACION = factor(CALIFICACION, c("No Calificados", "Operativos", "Técnicos", "Profesionales")),
                                       TIPOCALIFICACION= case_when(CALIFICACION=="Profesionales" | CALIFICACION== "Técnicos" ~ "Calificado",
                                                                          CALIFICACION=="No Calificados" | CALIFICACION=="Operativos" ~ "No calificado"))
                                

caract<- ephtotalsd %>% group_by(SECTOR) %>% filter(OCUPADOS==1) %>% count()
caes<- read.csv("SECTORESCAES.csv", sep = ";", colClasses = "character")
sectores<- left_join(ephtotalsd,caes)
table(sectores$SECTOR_ACT)

```

###Tasa de informalidad laboral desagregada por sector de actividad
```{r}
inforporsector<- function(i) {
  infor <- sectores %>% filter(AGLOMERADO==12  & !is.na(INFORMALES) & SECTOR_ACT==i)
  infor <- infor %>% group_by(INFORMALES) %>%  summarise(SECTOR=i, porcentaje=formattable::percent(sum(PONDERA)/sum(infor$PONDERA), digits=2)) 
  return(infor)
}
nombres<-(unique(sectores$SECTOR_ACT))
nombres


c((lapply(nombres, inforporsector))) #lapply aplica una función a cada elemento de una lista o vector


#inforporsector("INFORMACIÓN Y COMUNICACIÓN")
#inforporsector("ENSEÑANZA")
#inforporsector("CONSTRUCCIÓN")
#inforporsector("ADMINISTRACIÓN PÚBLICA Y DEFENSA; PLANES DE SEGURO SOCIAL OBLIGATORIO" )
#inforporsector("ACTIVIDADES PROFESIONALES, CIENTÍFICAS Y TÉCNICAS")
#inforporsector("SALUD HUMANA Y SERVICIOS SOCIALES")
#inforporsector("ACTIVIDADES FINANCIERAS Y DE SEGUROS" )
#inforporsector("COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACIÓN DE VEHÍCULOS AUTOMOTORES Y MOTOCICLETAS")
#inforporsector("INDUSTRIA MANUFACTURERA")
#inforporsector("TRANSPORTE Y ALMACENAMIENTO" )
#inforporsector("ARTES, ENTRETENIMIENTO Y RECREACIÓN")
#inforporsector("AGRICULTURA, GANADERÍA, CAZA, SILVICULTURA Y PESCA")
#inforporsector("ACTIVIDADES DE LOS HOGARES COMO EMPLEADORES DE\nPERSONAL DOMÉSTICO" )
#inforporsector("OTRAS ACTIVIDADES DE SERVICIOS")
#inforporsector("ACTIVIDADES DE ORGANIZACIONES Y ORGANISMOS\nEXTRATERRITORIALES")
#inforporsector("ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO" )
#inforporsector("ALOJAMIENTO Y SERVICIOS DE COMIDAS")
#inforporsector("EXPLOTACIÓN DE MINAS Y CANTERAS")
#inforporsector("SUMINISTRO DE ELECTRICIDAD, GAS, VAPOR Y AIRE\nACONDICIONADO")
#inforporsector("SUMINISTRO DE AGUA; ALCANTARILLADO, GESTIÓN DE DESECHOS Y ACTIVIDADES DE SANEAMIENTO")
#inforporsector("ACTIVIDADES INMOBILIARIAS" )
```

##Calificación por sector
```{r}
califporsector<- function(i) {
  calif <- sectores %>% filter(AGLOMERADO==12  & !is.na(TIPOCALIFICACION) & SECTOR_ACT==i)
  calif <- calif %>% group_by(TIPOCALIFICACION) %>%  summarise(SECTOR=i, porcentaje=formattable::percent(sum(PONDERA)/sum(calif$PONDERA), digits=2))
  return(calif)
}

califporsector("INFORMACIÓN Y COMUNICACIÓN")
califporsector("ENSEÑANZA")
califporsector("CONSTRUCCIÓN")
califporsector("ADMINISTRACIÓN PÚBLICA Y DEFENSA; PLANES DE SEGURO SOCIAL OBLIGATORIO" )
califporsector("ACTIVIDADES PROFESIONALES, CIENTÍFICAS Y TÉCNICAS")
califporsector("SALUD HUMANA Y SERVICIOS SOCIALES")
califporsector("ACTIVIDADES FINANCIERAS Y DE SEGUROS" )
califporsector("COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACIÓN DE VEHÍCULOS AUTOMOTORES Y MOTOCICLETAS")
califporsector("INDUSTRIA MANUFACTURERA")
califporsector("TRANSPORTE Y ALMACENAMIENTO" )
califporsector("ARTES, ENTRETENIMIENTO Y RECREACIÓN")
califporsector("AGRICULTURA, GANADERÍA, CAZA, SILVICULTURA Y PESCA")
califporsector("ACTIVIDADES DE LOS HOGARES COMO EMPLEADORES DE\nPERSONAL DOMÉSTICO" )
califporsector("OTRAS ACTIVIDADES DE SERVICIOS")
califporsector("ACTIVIDADES DE ORGANIZACIONES Y ORGANISMOS\nEXTRATERRITORIALES")
califporsector("ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO" )
califporsector("ALOJAMIENTO Y SERVICIOS DE COMIDAS")
califporsector("EXPLOTACIÓN DE MINAS Y CANTERAS")
califporsector("SUMINISTRO DE ELECTRICIDAD, GAS, VAPOR Y AIRE\nACONDICIONADO")
califporsector("SUMINISTRO DE AGUA; ALCANTARILLADO, GESTIÓN DE DESECHOS Y ACTIVIDADES DE SANEAMIENTO")
califporsector("ACTIVIDADES INMOBILIARIAS" )


table(sectores$SECTOR_ACT)

```

